<html>
<head>
<title>OIOSAML.java installation</title>
        <style type="text/css">
    	body {background-color: white; margin: 20px;}
    	body, tr, td {font-family: Verdana, Helvetica, sans-serif; color: #456974;}
    	div#pagecontainer {width: 80%;}
    	h1, h2, h3, h4 {color: #76c2bc; border-bottom: 1px solid #76c2bc;}
    	.monospace {font-family: monospace;}
    	legend {font-weight: bold;}
    	fieldset {margin-top: 10px; margin-bottom: 10px;}
    	span.emphasis {font-weight: bold;}
    </style>
</head>
<body>

<h2>OIOSAML.java installation</h2>

<p>Installation of OIOSAML.java consists of adding a dependency too a web application, editing web.xml, and configuring OIOSAML.java. 
For configuration, see <a href="configuration.html">the configuration guide</a>.</p>

<p>The OIOSAML.java library is published as a Maven dependency here:</p>

<a href="https://mvnrepository.com/artifact/dk.digst/oiosaml2.java">OIOSAML.java Maven Repository</a>.

<p>The demo application shows how to use the framework, and the source for the demo application is bundled with the source for OIOSAML here:</p>

<a href="https://github.com/digst/OIOSAML.Java">OIOSAML.java source code</a>.

<h3>Demo installation</h3>
<p>
The demo application can be compiled and executed using Maven, and the build-in tomcat maven plugin like this
</p>

<pre>
$ mvn clean install tomcat7:run-war
</pre>

<p>
The demo application is pre-configured to run, and can be accessed here:</p>

<pre>
https://localhost:8443/oiosaml2-demo.java
</pre>

<h3>Real installation</h3>
<p>To install OIOSAML.java in your own web application, do the following: </p>
<ol>
<li>Add the oiosaml dependency</li>
<li>Edit your web.xml and add the following: 
<pre>
&lt;env-entry&gt;
    &lt;env-entry-name&gt;oiosaml-j.home&lt;/env-entry-name&gt;
    &lt;env-entry-value&gt;/path/to/oiosaml.home&lt;/env-entry-value&gt;
    &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;
&lt;/env-entry&gt;

&lt;listener&gt;
	&lt;listener-class&gt;dk.itst.oiosaml.sp.service.session.SessionDestroyListener&lt;/listener-class&gt;
&lt;/listener&gt;

&lt;servlet&gt;
	&lt;servlet-name&gt;SAMLDispatcherServlet&lt;/servlet-name&gt;
	&lt;servlet-class&gt;dk.itst.oiosaml.sp.service.DispatcherServlet&lt;/servlet-class&gt;
&lt;/servlet&gt;

&lt;servlet-mapping&gt;
	&lt;servlet-name&gt;SAMLDispatcherServlet&lt;/servlet-name&gt;
	&lt;url-pattern&gt;/saml/*&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;

&lt;filter&gt;
	&lt;filter-name&gt;LoginFilter&lt;/filter-name&gt;
	&lt;filter-class&gt;dk.itst.oiosaml.sp.service.SPFilter&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;LoginFilter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/protected/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</pre>
</ol>

<p>This defines a servlet which handles all SAML related requests, such as Single Logout, Login Responses, and so on. /saml/ is the recommended prefix for this servlet.
Furthermore, a protection filter is defined. This filter handles user authentication, and only allows access to the protected resources if the user is authenticated correctly. The filter can
cover the SAML servlet, this does not make any difference. The listener makes sure assertions are cleaned up as soon sessions are expired. The listener is not strictly necessary, but it is good practice to include it.</p> 

<p>When OIOSAML.java is started, it will check if it is configured correctly. If not, autoconfig is enabled, and you can visit saml/configure to configure the system.</p>

<p>When the system has been configured, the SP metadata can be downloaded from saml/metadata. The metadata is automatically signed when downloading it.</p>
</body>
</html>
